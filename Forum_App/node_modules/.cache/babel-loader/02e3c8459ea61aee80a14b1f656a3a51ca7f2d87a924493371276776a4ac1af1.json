{"ast":null,"code":"import { vModelText as _vModelText, createElementVNode as _createElementVNode, withDirectives as _withDirectives, createTextVNode as _createTextVNode, openBlock as _openBlock, createElementBlock as _createElementBlock, createCommentVNode as _createCommentVNode, toDisplayString as _toDisplayString, normalizeClass as _normalizeClass } from \"vue\";\nvar _hoisted_1 = [\"id\"];\nvar _hoisted_2 = {\n  key: 0,\n  \"class\": \"edit-mode\"\n};\nvar _hoisted_3 = {\n  \"class\": \"edit-actions\"\n};\nvar _hoisted_4 = {\n  key: 1,\n  \"class\": \"response-content\"\n};\nvar _hoisted_5 = {\n  \"class\": \"response-text\"\n};\nvar _hoisted_6 = {\n  \"class\": \"response-meta\"\n};\nvar _hoisted_7 = {\n  \"class\": \"author-info\"\n};\nvar _hoisted_8 = {\n  \"class\": \"date-info\"\n};\nvar _hoisted_9 = {\n  key: 0,\n  \"class\": \"edited-badge\"\n};\nvar _hoisted_10 = {\n  key: 0,\n  \"class\": \"response-actions\"\n};\nvar _hoisted_11 = {\n  key: 1,\n  \"class\": \"admin-badge\"\n};\nexport function render(_ctx, _cache, $props, $setup, $data, $options) {\n  return _openBlock(), _createElementBlock(\"div\", {\n    \"class\": _normalizeClass([\"response-item\", {\n      'highlight-reply': $setup.isHighlighted\n    }]),\n    id: $props.response.id\n  }, [$setup.isEditing ? (_openBlock(), _createElementBlock(\"div\", _hoisted_2, [_withDirectives(_createElementVNode(\"textarea\", {\n    \"onUpdate:modelValue\": _cache[0] || (_cache[0] = function ($event) {\n      return $setup.editedContent = $event;\n    }),\n    \"class\": \"edit-textarea\",\n    placeholder: \"Edit your response...\"\n  }, null, 512 /* NEED_PATCH */), [[_vModelText, $setup.editedContent]]), _createElementVNode(\"div\", _hoisted_3, [_createElementVNode(\"button\", {\n    onClick: _cache[1] || (_cache[1] = function () {\n      return $setup.saveResponse && $setup.saveResponse.apply($setup, arguments);\n    }),\n    \"class\": \"save-button\"\n  }, _cache[5] || (_cache[5] = [_createElementVNode(\"i\", {\n    \"class\": \"fas fa-check\"\n  }, null, -1 /* HOISTED */), _createTextVNode(\" Save \")])), _createElementVNode(\"button\", {\n    onClick: _cache[2] || (_cache[2] = function () {\n      return $setup.cancelEdit && $setup.cancelEdit.apply($setup, arguments);\n    }),\n    \"class\": \"cancel-button\"\n  }, _cache[6] || (_cache[6] = [_createElementVNode(\"i\", {\n    \"class\": \"fas fa-times\"\n  }, null, -1 /* HOISTED */), _createTextVNode(\" Cancel \")]))])])) : (_openBlock(), _createElementBlock(\"div\", _hoisted_4, [_createElementVNode(\"p\", _hoisted_5, _toDisplayString($props.response.contenu), 1 /* TEXT */), _createElementVNode(\"div\", _hoisted_6, [_createElementVNode(\"div\", _hoisted_7, [_cache[7] || (_cache[7] = _createElementVNode(\"i\", {\n    \"class\": \"fas fa-user\"\n  }, null, -1 /* HOISTED */)), _createElementVNode(\"span\", null, _toDisplayString($props.response.authorName || $props.response.authorId), 1 /* TEXT */)]), _createElementVNode(\"div\", _hoisted_8, [_cache[8] || (_cache[8] = _createElementVNode(\"i\", {\n    \"class\": \"far fa-clock\"\n  }, null, -1 /* HOISTED */)), _createElementVNode(\"span\", null, _toDisplayString($setup.formattedDate), 1 /* TEXT */), $props.response.updatedAt ? (_openBlock(), _createElementBlock(\"span\", _hoisted_9, \"(edited)\")) : _createCommentVNode(\"v-if\", true)])]), $setup.isAuthor || $props.isAdmin ? (_openBlock(), _createElementBlock(\"div\", _hoisted_10, [$setup.isAuthor ? (_openBlock(), _createElementBlock(\"button\", {\n    key: 0,\n    onClick: _cache[3] || (_cache[3] = function () {\n      return $setup.editResponse && $setup.editResponse.apply($setup, arguments);\n    }),\n    \"class\": \"edit-button\"\n  }, _cache[9] || (_cache[9] = [_createElementVNode(\"i\", {\n    \"class\": \"fas fa-edit\"\n  }, null, -1 /* HOISTED */), _createTextVNode(\" Edit \")]))) : _createCommentVNode(\"v-if\", true), _createElementVNode(\"button\", {\n    onClick: _cache[4] || (_cache[4] = function () {\n      return $setup.deleteResponse && $setup.deleteResponse.apply($setup, arguments);\n    }),\n    \"class\": \"delete-button\"\n  }, _cache[10] || (_cache[10] = [_createElementVNode(\"i\", {\n    \"class\": \"fas fa-trash\"\n  }, null, -1 /* HOISTED */), _createTextVNode(\" Delete \")])), $props.isAdmin && !$setup.isAuthor ? (_openBlock(), _createElementBlock(\"span\", _hoisted_11, \"Admin Action\")) : _createCommentVNode(\"v-if\", true)])) : _createCommentVNode(\"v-if\", true)]))], 10 /* CLASS, PROPS */, _hoisted_1);\n}","map":{"version":3,"names":["key","_createElementBlock","_normalizeClass","$setup","isHighlighted","id","$props","response","isEditing","_hoisted_2","_createElementVNode","_cache","$event","editedContent","placeholder","_hoisted_3","onClick","saveResponse","apply","arguments","_createTextVNode","cancelEdit","_hoisted_4","_hoisted_5","_toDisplayString","contenu","_hoisted_6","_hoisted_7","authorName","authorId","_hoisted_8","formattedDate","updatedAt","_hoisted_9","_createCommentVNode","isAuthor","isAdmin","_hoisted_10","editResponse","deleteResponse","_hoisted_11","_hoisted_1"],"sources":["/workspaces/Mini_Projects_Js/Forum_App/src/components/ResponseItem.vue"],"sourcesContent":["<template>\r\n  <div \r\n    class=\"response-item\" \r\n    :id=\"response.id\"\r\n    :class=\"{ 'highlight-reply': isHighlighted }\"\r\n  >\r\n    <div v-if=\"isEditing\" class=\"edit-mode\">\r\n      <textarea\r\n        v-model=\"editedContent\"\r\n        class=\"edit-textarea\"\r\n        placeholder=\"Edit your response...\"\r\n      ></textarea>\r\n      <div class=\"edit-actions\">\r\n        <button\r\n          @click=\"saveResponse\"\r\n          class=\"save-button\"\r\n        >\r\n          <i class=\"fas fa-check\"></i> Save\r\n        </button>\r\n        <button\r\n          @click=\"cancelEdit\"\r\n          class=\"cancel-button\"\r\n        >\r\n          <i class=\"fas fa-times\"></i> Cancel\r\n        </button>\r\n      </div>\r\n    </div>\r\n    <div v-else class=\"response-content\">\r\n      <p class=\"response-text\">{{ response.contenu }}</p>\r\n      <div class=\"response-meta\">\r\n        <div class=\"author-info\">\r\n          <i class=\"fas fa-user\"></i>\r\n          <span>{{ response.authorName || response.authorId }}</span>\r\n        </div>\r\n        <div class=\"date-info\">\r\n          <i class=\"far fa-clock\"></i>\r\n          <span>{{ formattedDate }}</span>\r\n          <span v-if=\"response.updatedAt\" class=\"edited-badge\">(edited)</span>\r\n        </div>\r\n      </div>\r\n\r\n      <div v-if=\"isAuthor || isAdmin\" class=\"response-actions\">\r\n        <button\r\n          v-if=\"isAuthor\"\r\n          @click=\"editResponse\"\r\n          class=\"edit-button\"\r\n        >\r\n          <i class=\"fas fa-edit\"></i> Edit\r\n        </button>\r\n        <button\r\n          @click=\"deleteResponse\"\r\n          class=\"delete-button\"\r\n        >\r\n          <i class=\"fas fa-trash\"></i> Delete\r\n        </button>\r\n        <span v-if=\"isAdmin && !isAuthor\" class=\"admin-badge\">Admin Action</span>\r\n      </div>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport { getAuth } from 'firebase/auth'\r\nimport { getFirestore, doc, updateDoc, deleteDoc, serverTimestamp } from 'firebase/firestore'\r\nimport { computed, ref, onMounted } from 'vue'\r\nimport { useRoute } from 'vue-router'\r\n\r\nexport default {\r\n  name: 'ResponseItem',\r\n  props: {\r\n    response: Object,\r\n    isAdmin: {\r\n      type: Boolean,\r\n      default: false\r\n    }\r\n  },\r\n  emits: ['response-deleted', 'response-updated'],\r\n  setup(props, { emit }) {\r\n    const db = getFirestore()\r\n    const auth = getAuth()\r\n    const route = useRoute()\r\n\r\n    // State for the editing process\r\n    const isEditing = ref(false)\r\n    const editedContent = ref(props.response.contenu)\r\n    const isHighlighted = ref(false)\r\n\r\n    // Check if the current user is the author\r\n    const isAuthor = computed(() => {\r\n      return auth.currentUser && auth.currentUser.uid === props.response.authorId\r\n    })\r\n\r\n    // Format the creation date\r\n    const formattedDate = computed(() => {\r\n      if (!props.response.createdAt) return ''\r\n      const date = props.response.createdAt.toDate \r\n        ? props.response.createdAt.toDate() \r\n        : new Date(props.response.createdAt.seconds * 1000)\r\n      return date.toLocaleString()\r\n    })\r\n\r\n    // Check if this response should be highlighted from URL hash\r\n    const checkHighlight = () => {\r\n      if (route.hash === `#${props.response.id}`) {\r\n        isHighlighted.value = true\r\n        setTimeout(() => {\r\n          isHighlighted.value = false\r\n        }, 3000)\r\n      }\r\n    }\r\n\r\n    // Edit button click handler\r\n    const editResponse = () => {\r\n      isEditing.value = true\r\n    }\r\n\r\n    // Save the edited response to Firestore\r\n    const saveResponse = async () => {\r\n      try {\r\n        const responseRef = doc(db, 'responses', props.response.id)\r\n        await updateDoc(responseRef, {\r\n          contenu: editedContent.value,\r\n          updatedAt: serverTimestamp() // Use serverTimestamp for consistency\r\n        })\r\n        \r\n        // Update local state\r\n        props.response.contenu = editedContent.value\r\n        props.response.updatedAt = new Date() // Update local copy\r\n        emit('response-updated', { \r\n          id: props.response.id, \r\n          newContent: editedContent.value \r\n        })\r\n        isEditing.value = false\r\n      } catch (error) {\r\n        console.error('Error saving response:', error)\r\n        alert('Failed to save response: ' + error.message)\r\n      }\r\n    }\r\n\r\n    // Cancel editing\r\n    const cancelEdit = () => {\r\n      isEditing.value = false\r\n      editedContent.value = props.response.contenu\r\n    }\r\n\r\n    // Delete the response from Firestore\r\n    const deleteResponse = async () => {\r\n      const message = props.isAdmin && !isAuthor.value \r\n        ? 'Are you sure you want to delete this response as admin?'\r\n        : 'Are you sure you want to delete your response?'\r\n      \r\n      if (confirm(message)) {\r\n        try {\r\n          await deleteDoc(doc(db, 'responses', props.response.id))\r\n          emit('response-deleted', props.response.id)\r\n        } catch (error) {\r\n          console.error('Error deleting response:', error)\r\n          alert('Failed to delete response: ' + error.message)\r\n        }\r\n      }\r\n    }\r\n\r\n    onMounted(() => {\r\n      checkHighlight()\r\n    })\r\n\r\n    return {\r\n      deleteResponse,\r\n      editResponse,\r\n      saveResponse,\r\n      cancelEdit,\r\n      isAuthor,\r\n      isEditing,\r\n      isHighlighted,\r\n      editedContent,\r\n      formattedDate\r\n    }\r\n  }\r\n}\r\n</script>\r\n\r\n<style scoped>\r\n.response-item {\r\n  background: white;\r\n  border-radius: 10px;\r\n  padding: 1.5rem;\r\n  margin-bottom: 1.25rem;\r\n  box-shadow: 0 2px 8px rgba(0, 0, 0, 0.05);\r\n  transition: all 0.3s cubic-bezier(0.25, 0.8, 0.25, 1);\r\n  border-left: 3px solid transparent;\r\n}\r\n\r\n.response-item:hover {\r\n  box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);\r\n}\r\n\r\n.highlight-reply {\r\n  animation: highlight-fade 3s ease-out;\r\n  border-left-color: #3498db;\r\n  background-color: rgba(52, 152, 219, 0.03);\r\n}\r\n\r\n.edit-mode {\r\n  display: flex;\r\n  flex-direction: column;\r\n  gap: 1rem;\r\n}\r\n\r\n.edit-textarea {\r\n  width: 100%;\r\n  padding: 1rem;\r\n  border-radius: 8px;\r\n  border: 1px solid #e0e0e0;\r\n  font-family: inherit;\r\n  font-size: 1rem;\r\n  line-height: 1.5;\r\n  min-height: 120px;\r\n  transition: border-color 0.3s;\r\n  resize: vertical;\r\n}\r\n\r\n.edit-textarea:focus {\r\n  outline: none;\r\n  border-color: #3498db;\r\n  box-shadow: 0 0 0 2px rgba(52, 152, 219, 0.2);\r\n}\r\n\r\n.edit-actions {\r\n  display: flex;\r\n  gap: 0.75rem;\r\n}\r\n\r\n.save-button, .cancel-button,\r\n.edit-button, .delete-button {\r\n  display: inline-flex;\r\n  align-items: center;\r\n  gap: 0.5rem;\r\n  padding: 0.5rem 1rem;\r\n  border-radius: 6px;\r\n  font-size: 0.9rem;\r\n  cursor: pointer;\r\n  transition: all 0.2s;\r\n  border: none;\r\n}\r\n\r\n.save-button {\r\n  background-color: #28a745;\r\n  color: white;\r\n}\r\n\r\n.save-button:hover {\r\n  background-color: #218838;\r\n}\r\n\r\n.cancel-button {\r\n  background-color: #6c757d;\r\n  color: white;\r\n}\r\n\r\n.cancel-button:hover {\r\n  background-color: #5a6268;\r\n}\r\n\r\n.response-text {\r\n  font-size: 1rem;\r\n  line-height: 1.6;\r\n  color: #2c3e50;\r\n  margin-bottom: 1rem;\r\n}\r\n\r\n.response-meta {\r\n  display: flex;\r\n  justify-content: space-between;\r\n  font-size: 0.85rem;\r\n  color: #7f8c8d;\r\n  margin-bottom: 1rem;\r\n}\r\n\r\n.author-info, .date-info {\r\n  display: flex;\r\n  align-items: center;\r\n  gap: 0.5rem;\r\n}\r\n\r\n.edited-badge {\r\n  color: #95a5a6;\r\n  font-style: italic;\r\n  margin-left: 0.3rem;\r\n}\r\n\r\n.response-actions {\r\n  display: flex;\r\n  gap: 0.75rem;\r\n  align-items: center;\r\n}\r\n\r\n.edit-button {\r\n  background-color: #007bff;\r\n  color: white;\r\n}\r\n\r\n.edit-button:hover {\r\n  background-color: #0069d9;\r\n}\r\n\r\n.delete-button {\r\n  background-color: #dc3545;\r\n  color: white;\r\n}\r\n\r\n.delete-button:hover {\r\n  background-color: #c82333;\r\n}\r\n\r\n.admin-badge {\r\n  font-size: 0.75rem;\r\n  color: #6c757d;\r\n  background-color: #f8f9fa;\r\n  padding: 0.25rem 0.5rem;\r\n  border-radius: 4px;\r\n  margin-left: 0.5rem;\r\n}\r\n\r\n@keyframes highlight-fade {\r\n  0% { \r\n    background-color: rgba(52, 152, 219, 0.1);\r\n    box-shadow: 0 0 0 2px rgba(52, 152, 219, 0.2);\r\n  }\r\n  100% { \r\n    background-color: rgba(52, 152, 219, 0.03);\r\n    box-shadow: 0 2px 8px rgba(0, 0, 0, 0.05);\r\n  }\r\n}\r\n\r\n@media (max-width: 768px) {\r\n  .response-item {\r\n    padding: 1.25rem;\r\n  }\r\n  \r\n  .response-meta {\r\n    flex-direction: column;\r\n    gap: 0.5rem;\r\n    align-items: flex-start;\r\n  }\r\n  \r\n  .edit-textarea {\r\n    min-height: 100px;\r\n  }\r\n\r\n  .response-actions {\r\n    flex-wrap: wrap;\r\n  }\r\n}\r\n</style>"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}